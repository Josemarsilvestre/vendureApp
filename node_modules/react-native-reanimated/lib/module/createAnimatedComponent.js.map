{"version":3,"names":["React","findNodeHandle","Platform","StyleSheet","WorkletEventHandler","setAndForwardRef","invariant","adaptViewConfig","RNRenderer","configureLayoutAnimations","enableLayoutAnimations","runOnUI","startMapper","stopMapper","isJest","isChromeDebugger","shouldBeUseWeb","initialUpdaterRun","DefaultSharedTransition","LayoutAnimationType","makeViewDescriptorsSet","getShadowNodeWrapperFromRef","updateProps","NativeReanimatedModule","isSharedValue","dummyListener","maybeBuild","layoutAnimationOrBuilder","isAnimationBuilder","value","build","flattenArray","array","Array","isArray","resultArr","_flattenArray","arr","forEach","item","push","onlyAnimatedStyles","styles","filter","style","viewDescriptors","isSameAnimatedStyle","style1","style2","viewsRef","isSameAnimatedProps","has","key","x","undefined","isInlineStyleTransform","transform","some","t","hasInlineStyles","Object","keys","styleValue","extractSharedValuesMapFromProps","props","inlineProps","entries","inlinePropsHasChanged","styles1","styles2","length","getInlinePropsUpdate","update","map","createAnimatedComponent","Component","options","prototype","isReactComponent","name","AnimatedComponent","constructor","_defineProperty","getForwardedRef","forwardedRef","setLocalRef","ref","tag","layout","entering","exiting","sharedTransitionTag","LAYOUT","ENTERING","EXITING","sharedElementTransition","sharedTransitionStyle","SHARED_ELEMENT_TRANSITION","_component","animatedStyle","componentWillUnmount","_detachNativeEvents","_detachStyles","_detachInlineProps","componentDidMount","_attachNativeEvents","_attachAnimatedStyles","_attachInlineProps","_getEventViewRef","_this$_component","getScrollableNode","node","viewTag","prop","current","setNativeProps","registerForEvents","unregisterFromEvents","OS","_styles","remove","_viewTag","_this$props$animatedP","animatedProps","global","_IS_FABRIC","_removeShadowNodeFromRegistry","_reattachNativeEvents","prevProps","reattachNeeded","_updateFromNative","_this$_component2","_this$_component2$set","call","_getViewInfo","_this$_component3","viewName","shadowNodeWrapper","viewConfig","component","getAnimatableRef","_hostInstance$viewCon","hostInstance","findHostInstance_DEPRECATED","Error","_nativeTag","uiViewClassName","_this$props$animatedP2","_this$props$animatedP3","prevStyles","prevAnimatedProps","_animatedProps","hasReanimated2Props","hasOneSameStyle","prevStyle","isPresent","add","initial","newInlineProps","hasChanged","_inlineProps","_inlinePropsViewDescriptors","sharableViewDescriptors","maybeViewRef","native","items","Set","updaterFunction","_inlinePropsMapperId","values","componentDidUpdate","_filterNonAnimatedProps","inputProps","styleProp","processedStyle","_isFirstRender","initialStyle","updater","newStyle","flatten","animatedProp","_animatedProp$initial","_animatedProp$viewsRe","eventNames","eventName","listeners","render","platformProps","select","web","default","collapsable","createElement","_extends","_setComponentRef","displayName","forwardRef"],"sources":["createAnimatedComponent.tsx"],"sourcesContent":["import React, { Component, ComponentType, MutableRefObject, Ref } from 'react';\nimport { findNodeHandle, Platform, StyleSheet } from 'react-native';\nimport WorkletEventHandler from './reanimated2/WorkletEventHandler';\nimport setAndForwardRef from './setAndForwardRef';\nimport './reanimated2/layoutReanimation/animationsManager';\nimport invariant from 'invariant';\nimport { adaptViewConfig } from './ConfigHelper';\nimport { RNRenderer } from './reanimated2/platform-specific/RNRenderer';\nimport {\n  configureLayoutAnimations,\n  enableLayoutAnimations,\n  runOnUI,\n  startMapper,\n  stopMapper,\n} from './reanimated2/core';\nimport {\n  isJest,\n  isChromeDebugger,\n  shouldBeUseWeb,\n} from './reanimated2/PlatformChecker';\nimport { initialUpdaterRun } from './reanimated2/animation';\nimport {\n  BaseAnimationBuilder,\n  DefaultSharedTransition,\n  EntryExitAnimationFunction,\n  ILayoutAnimationBuilder,\n  LayoutAnimationFunction,\n  LayoutAnimationType,\n} from './reanimated2/layoutReanimation';\nimport {\n  SharedValue,\n  StyleProps,\n  ShadowNodeWrapper,\n} from './reanimated2/commonTypes';\nimport {\n  makeViewDescriptorsSet,\n  ViewDescriptorsSet,\n  ViewRefSet,\n} from './reanimated2/ViewDescriptorsSet';\nimport { getShadowNodeWrapperFromRef } from './reanimated2/fabricUtils';\nimport updateProps from './reanimated2/UpdateProps';\nimport NativeReanimatedModule from './reanimated2/NativeReanimated';\nimport { isSharedValue } from './reanimated2';\n\nfunction dummyListener() {\n  // empty listener we use to assign to listener properties for which animated\n  // event is used.\n}\n\nfunction maybeBuild(\n  layoutAnimationOrBuilder:\n    | ILayoutAnimationBuilder\n    | LayoutAnimationFunction\n    | Keyframe\n): LayoutAnimationFunction | Keyframe {\n  const isAnimationBuilder = (\n    value: ILayoutAnimationBuilder | LayoutAnimationFunction | Keyframe\n  ): value is ILayoutAnimationBuilder =>\n    'build' in layoutAnimationOrBuilder &&\n    typeof layoutAnimationOrBuilder.build === 'function';\n\n  if (isAnimationBuilder(layoutAnimationOrBuilder)) {\n    return layoutAnimationOrBuilder.build();\n  } else {\n    return layoutAnimationOrBuilder;\n  }\n}\n\ntype NestedArray<T> = T | NestedArray<T>[];\nfunction flattenArray<T>(array: NestedArray<T>): T[] {\n  if (!Array.isArray(array)) {\n    return [array];\n  }\n  const resultArr: T[] = [];\n\n  const _flattenArray = (arr: NestedArray<T>[]): void => {\n    arr.forEach((item) => {\n      if (Array.isArray(item)) {\n        _flattenArray(item);\n      } else {\n        resultArr.push(item);\n      }\n    });\n  };\n  _flattenArray(array);\n  return resultArr;\n}\n\nfunction onlyAnimatedStyles(styles: StyleProps[]) {\n  return styles.filter((style) => style?.viewDescriptors);\n}\n\nfunction isSameAnimatedStyle(\n  style1?: StyleProps,\n  style2?: StyleProps\n): boolean {\n  // We cannot use equality check to compare useAnimatedStyle outputs directly.\n  // Instead, we can compare its viewsRefs.\n  return style1?.viewsRef === style2?.viewsRef;\n}\n\nconst isSameAnimatedProps = isSameAnimatedStyle;\n\nconst has = <K extends string>(\n  key: K,\n  x: unknown\n): x is { [key in K]: unknown } => {\n  if (typeof x === 'function' || typeof x === 'object') {\n    if (x === null || x === undefined) {\n      return false;\n    } else {\n      return key in x;\n    }\n  }\n  return false;\n};\n\nfunction isInlineStyleTransform(transform: any): boolean {\n  if (!transform) {\n    return false;\n  }\n  return transform.some((t: Record<string, any>) => hasInlineStyles(t));\n}\n\nfunction hasInlineStyles(style: StyleProps): boolean {\n  if (!style) {\n    return false;\n  }\n  return Object.keys(style).some((key) => {\n    const styleValue = style[key];\n    return (\n      isSharedValue(styleValue) ||\n      (key === 'transform' && isInlineStyleTransform(styleValue))\n    );\n  });\n}\n\nfunction extractSharedValuesMapFromProps(\n  props: AnimatedComponentProps<InitialComponentProps>\n): Record<string, any> {\n  const inlineProps: Record<string, any> = {};\n\n  for (const key in props) {\n    const value = props[key];\n    if (key === 'style') {\n      const styles = flattenArray<StyleProps>(props.style ?? []);\n      styles.forEach((style) => {\n        if (!style) {\n          return;\n        }\n        for (const [key, styleValue] of Object.entries(style)) {\n          if (isSharedValue(styleValue)) {\n            inlineProps[key] = styleValue;\n          } else if (\n            key === 'transform' &&\n            isInlineStyleTransform(styleValue)\n          ) {\n            inlineProps[key] = styleValue;\n          }\n        }\n      });\n    } else if (isSharedValue(value)) {\n      inlineProps[key] = value;\n    }\n  }\n\n  return inlineProps;\n}\n\nfunction inlinePropsHasChanged(styles1: StyleProps, styles2: StyleProps) {\n  if (Object.keys(styles1).length !== Object.keys(styles2).length) {\n    return true;\n  }\n\n  for (const key of Object.keys(styles1)) {\n    if (styles1[key] !== styles2[key]) return true;\n  }\n\n  return false;\n}\n\nfunction getInlinePropsUpdate(inlineProps: Record<string, any>) {\n  'worklet';\n  const update: Record<string, any> = {};\n  for (const [key, styleValue] of Object.entries(inlineProps)) {\n    if (key === 'transform') {\n      update[key] = styleValue.map((transform: Record<string, any>) => {\n        return getInlinePropsUpdate(transform);\n      });\n    } else if (isSharedValue(styleValue)) {\n      update[key] = styleValue.value;\n    } else {\n      update[key] = styleValue;\n    }\n  }\n  return update;\n}\n\ninterface AnimatedProps extends Record<string, unknown> {\n  viewDescriptors?: ViewDescriptorsSet;\n  viewsRef?: ViewRefSet<unknown>;\n  initial?: SharedValue<StyleProps>;\n}\n\nexport type AnimatedComponentProps<P extends Record<string, unknown>> = P & {\n  forwardedRef?: Ref<Component>;\n  style?: NestedArray<StyleProps>;\n  animatedProps?: Partial<AnimatedComponentProps<AnimatedProps>>;\n  animatedStyle?: StyleProps;\n  layout?:\n    | BaseAnimationBuilder\n    | ILayoutAnimationBuilder\n    | typeof BaseAnimationBuilder;\n  entering?:\n    | BaseAnimationBuilder\n    | typeof BaseAnimationBuilder\n    | EntryExitAnimationFunction\n    | Keyframe;\n  exiting?:\n    | BaseAnimationBuilder\n    | typeof BaseAnimationBuilder\n    | EntryExitAnimationFunction\n    | Keyframe;\n  sharedTransitionTag?: string;\n  sharedTransitionStyle?: ILayoutAnimationBuilder;\n};\n\ntype Options<P> = {\n  setNativeProps: (ref: ComponentRef, props: P) => void;\n};\n\ninterface ComponentRef extends Component {\n  setNativeProps?: (props: Record<string, unknown>) => void;\n  getScrollableNode?: () => ComponentRef;\n  getAnimatableRef?: () => ComponentRef;\n}\n\nexport interface InitialComponentProps extends Record<string, unknown> {\n  ref?: Ref<Component>;\n  collapsable?: boolean;\n}\n\nexport default function createAnimatedComponent(\n  Component: ComponentType<InitialComponentProps>,\n  options?: Options<InitialComponentProps>\n): ComponentType<AnimatedComponentProps<InitialComponentProps>> {\n  invariant(\n    typeof Component !== 'function' ||\n      (Component.prototype && Component.prototype.isReactComponent),\n    `Looks like you're passing a function component \\`${Component.name}\\` to \\`createAnimatedComponent\\` function which supports only class components. Please wrap your function component with \\`React.forwardRef()\\` or use a class component instead.`\n  );\n\n  class AnimatedComponent extends React.Component<\n    AnimatedComponentProps<InitialComponentProps>\n  > {\n    _styles: StyleProps[] | null = null;\n    _animatedProps?: Partial<AnimatedComponentProps<AnimatedProps>>;\n    _viewTag = -1;\n    _isFirstRender = true;\n    animatedStyle: { value: StyleProps } = { value: {} };\n    initialStyle = {};\n    _component: ComponentRef | null = null;\n    _inlinePropsViewDescriptors: ViewDescriptorsSet | null = null;\n    _inlinePropsMapperId: number | null = null;\n    _inlineProps: StyleProps = {};\n    static displayName: string;\n\n    constructor(props: AnimatedComponentProps<InitialComponentProps>) {\n      super(props);\n      if (isJest()) {\n        this.animatedStyle = { value: {} };\n      }\n    }\n\n    componentWillUnmount() {\n      this._detachNativeEvents();\n      this._detachStyles();\n      this._detachInlineProps();\n    }\n\n    componentDidMount() {\n      this._attachNativeEvents();\n      this._attachAnimatedStyles();\n      this._attachInlineProps();\n    }\n\n    _getEventViewRef() {\n      // Make sure to get the scrollable node for components that implement\n      // `ScrollResponder.Mixin`.\n      return this._component?.getScrollableNode\n        ? this._component.getScrollableNode()\n        : this._component;\n    }\n\n    _attachNativeEvents() {\n      const node = this._getEventViewRef();\n      let viewTag = null; // We set it only if needed\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          if (viewTag === null) {\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n        }\n      }\n    }\n\n    _detachNativeEvents() {\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n    }\n\n    _detachStyles() {\n      if (Platform.OS === 'web' && this._styles !== null) {\n        for (const style of this._styles) {\n          if (style?.viewsRef) {\n            style.viewsRef.remove(this);\n          }\n        }\n      } else if (this._viewTag !== -1 && this._styles !== null) {\n        for (const style of this._styles) {\n          style.viewDescriptors.remove(this._viewTag);\n        }\n        if (this.props.animatedProps?.viewDescriptors) {\n          this.props.animatedProps.viewDescriptors.remove(this._viewTag);\n        }\n        if (global._IS_FABRIC) {\n          const viewTag = this._viewTag;\n          runOnUI(() => {\n            _removeShadowNodeFromRegistry!(viewTag);\n          })();\n        }\n      }\n    }\n\n    _reattachNativeEvents(\n      prevProps: AnimatedComponentProps<InitialComponentProps>\n    ) {\n      for (const key in prevProps) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          prop.current.unregisterFromEvents();\n        }\n      }\n\n      let viewTag = null;\n\n      for (const key in this.props) {\n        const prop = this.props[key];\n        if (\n          has('current', prop) &&\n          prop.current instanceof WorkletEventHandler &&\n          prop.current.reattachNeeded\n        ) {\n          if (viewTag === null) {\n            const node = this._getEventViewRef();\n            viewTag = findNodeHandle(options?.setNativeProps ? this : node);\n          }\n          prop.current.registerForEvents(viewTag as number, key);\n          prop.current.reattachNeeded = false;\n        }\n      }\n    }\n\n    _updateFromNative(props: StyleProps) {\n      if (options?.setNativeProps) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        options.setNativeProps(this._component!, props);\n      } else {\n        // eslint-disable-next-line no-unused-expressions\n        this._component?.setNativeProps?.(props);\n      }\n    }\n\n    _getViewInfo() {\n      let viewTag: number | null;\n      let viewName: string | null;\n      let shadowNodeWrapper: ShadowNodeWrapper | null = null;\n      let viewConfig;\n      // Component can specify ref which should be animated when animated version of the component is created.\n      // Otherwise, we animate the component itself.\n      const component = this._component?.getAnimatableRef\n        ? this._component.getAnimatableRef()\n        : this;\n      if (Platform.OS === 'web') {\n        viewTag = findNodeHandle(component);\n        viewName = null;\n        shadowNodeWrapper = null;\n        viewConfig = null;\n      } else {\n        // hostInstance can be null for a component that doesn't render anything (render function returns null). Example: svg Stop: https://github.com/react-native-svg/react-native-svg/blob/develop/src/elements/Stop.tsx\n        const hostInstance = RNRenderer.findHostInstance_DEPRECATED(component);\n        if (!hostInstance) {\n          throw new Error(\n            'Cannot find host instance for this component. Maybe it renders nothing?'\n          );\n        }\n        // we can access view tag in the same way it's accessed here https://github.com/facebook/react/blob/e3f4eb7272d4ca0ee49f27577156b57eeb07cf73/packages/react-native-renderer/src/ReactFabric.js#L146\n        viewTag = hostInstance?._nativeTag;\n        /**\n         * RN uses viewConfig for components for storing different properties of the component(example: https://github.com/facebook/react-native/blob/master/Libraries/Components/ScrollView/ScrollViewViewConfig.js#L16).\n         * The name we're looking for is in the field named uiViewClassName.\n         */\n        viewName = hostInstance?.viewConfig?.uiViewClassName;\n\n        viewConfig = hostInstance?.viewConfig;\n\n        if (global._IS_FABRIC) {\n          shadowNodeWrapper = getShadowNodeWrapperFromRef(this);\n        }\n      }\n      return { viewTag, viewName, shadowNodeWrapper, viewConfig };\n    }\n\n    _attachAnimatedStyles() {\n      const styles = this.props.style\n        ? onlyAnimatedStyles(flattenArray<StyleProps>(this.props.style))\n        : [];\n      const prevStyles = this._styles;\n      this._styles = styles;\n\n      const prevAnimatedProps = this._animatedProps;\n      this._animatedProps = this.props.animatedProps;\n\n      const { viewTag, viewName, shadowNodeWrapper, viewConfig } =\n        this._getViewInfo();\n\n      // update UI props whitelist for this view\n      const hasReanimated2Props =\n        this.props.animatedProps?.viewDescriptors || styles.length;\n      if (hasReanimated2Props && viewConfig) {\n        adaptViewConfig(viewConfig);\n      }\n\n      this._viewTag = viewTag as number;\n\n      // remove old styles\n      if (prevStyles) {\n        // in most of the cases, views have only a single animated style and it remains unchanged\n        const hasOneSameStyle =\n          styles.length === 1 &&\n          prevStyles.length === 1 &&\n          isSameAnimatedStyle(styles[0], prevStyles[0]);\n\n        if (!hasOneSameStyle) {\n          // otherwise, remove each style that is not present in new styles\n          for (const prevStyle of prevStyles) {\n            const isPresent = styles.some((style) =>\n              isSameAnimatedStyle(style, prevStyle)\n            );\n            if (!isPresent) {\n              prevStyle.viewDescriptors.remove(viewTag);\n            }\n          }\n        }\n      }\n\n      styles.forEach((style) => {\n        style.viewDescriptors.add({\n          tag: viewTag,\n          name: viewName,\n          shadowNodeWrapper,\n        });\n        if (isJest()) {\n          /**\n           * We need to connect Jest's TestObject instance whose contains just props object\n           * with the updateProps() function where we update the properties of the component.\n           * We can't update props object directly because TestObject contains a copy of props - look at render function:\n           * const props = this._filterNonAnimatedProps(this.props);\n           */\n          this.animatedStyle.value = {\n            ...this.animatedStyle.value,\n            ...style.initial.value,\n          };\n          style.animatedStyle.current = this.animatedStyle;\n        }\n      });\n\n      // detach old animatedProps\n      if (\n        prevAnimatedProps &&\n        !isSameAnimatedProps(prevAnimatedProps, this.props.animatedProps)\n      ) {\n        prevAnimatedProps.viewDescriptors!.remove(viewTag as number);\n      }\n\n      // attach animatedProps property\n      if (this.props.animatedProps?.viewDescriptors) {\n        this.props.animatedProps.viewDescriptors.add({\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          tag: viewTag!,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          name: viewName!,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          shadowNodeWrapper: shadowNodeWrapper!,\n        });\n      }\n    }\n\n    _attachInlineProps() {\n      const newInlineProps: Record<string, any> =\n        extractSharedValuesMapFromProps(this.props);\n      const hasChanged = inlinePropsHasChanged(\n        newInlineProps,\n        this._inlineProps\n      );\n\n      if (hasChanged) {\n        if (!this._inlinePropsViewDescriptors) {\n          this._inlinePropsViewDescriptors = makeViewDescriptorsSet();\n\n          const { viewTag, viewName, shadowNodeWrapper, viewConfig } =\n            this._getViewInfo();\n\n          if (Object.keys(newInlineProps).length && viewConfig) {\n            adaptViewConfig(viewConfig);\n          }\n\n          this._inlinePropsViewDescriptors.add({\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            tag: viewTag!,\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            name: viewName!,\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            shadowNodeWrapper: shadowNodeWrapper!,\n          });\n        }\n        const sharableViewDescriptors =\n          this._inlinePropsViewDescriptors.sharableViewDescriptors;\n\n        const maybeViewRef = NativeReanimatedModule.native\n          ? undefined\n          : ({ items: new Set([this]) } as ViewRefSet<any>); // see makeViewsRefSet\n\n        const updaterFunction = () => {\n          'worklet';\n          const update = getInlinePropsUpdate(newInlineProps);\n          updateProps(sharableViewDescriptors, update, maybeViewRef);\n        };\n        this._inlineProps = newInlineProps;\n        if (this._inlinePropsMapperId) {\n          stopMapper(this._inlinePropsMapperId);\n        }\n        this._inlinePropsMapperId = null;\n        if (Object.keys(newInlineProps).length) {\n          this._inlinePropsMapperId = startMapper(\n            updaterFunction,\n            Object.values(newInlineProps)\n          );\n        }\n      }\n    }\n\n    _detachInlineProps() {\n      if (this._inlinePropsMapperId) {\n        stopMapper(this._inlinePropsMapperId);\n      }\n    }\n\n    componentDidUpdate(\n      prevProps: AnimatedComponentProps<InitialComponentProps>\n    ) {\n      this._reattachNativeEvents(prevProps);\n      this._attachAnimatedStyles();\n      this._attachInlineProps();\n    }\n\n    _setComponentRef = setAndForwardRef<Component>({\n      getForwardedRef: () =>\n        this.props.forwardedRef as MutableRefObject<\n          Component<Record<string, unknown>, Record<string, unknown>, unknown>\n        >,\n      setLocalRef: (ref) => {\n        // TODO update config\n        const tag = findNodeHandle(ref);\n        const { layout, entering, exiting, sharedTransitionTag } = this.props;\n        if (\n          (layout || entering || exiting || sharedTransitionTag) &&\n          tag != null\n        ) {\n          if (!shouldBeUseWeb()) {\n            enableLayoutAnimations(true, false);\n          }\n          if (layout) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.LAYOUT,\n              maybeBuild(layout)\n            );\n          }\n          if (entering) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.ENTERING,\n              maybeBuild(entering)\n            );\n          }\n          if (exiting) {\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.EXITING,\n              maybeBuild(exiting)\n            );\n          }\n          if (sharedTransitionTag) {\n            const sharedElementTransition =\n              this.props.sharedTransitionStyle ?? DefaultSharedTransition;\n            configureLayoutAnimations(\n              tag,\n              LayoutAnimationType.SHARED_ELEMENT_TRANSITION,\n              maybeBuild(sharedElementTransition),\n              sharedTransitionTag\n            );\n          }\n        }\n\n        if (ref !== this._component) {\n          this._component = ref;\n        }\n      },\n    });\n\n    _filterNonAnimatedProps(\n      inputProps: AnimatedComponentProps<InitialComponentProps>\n    ): Record<string, unknown> {\n      const props: Record<string, unknown> = {};\n      for (const key in inputProps) {\n        const value = inputProps[key];\n        if (key === 'style') {\n          const styleProp = inputProps.style;\n          const styles = flattenArray<StyleProps>(styleProp ?? []);\n          const processedStyle: StyleProps = styles.map((style) => {\n            if (style && style.viewDescriptors) {\n              // this is how we recognize styles returned by useAnimatedStyle\n              style.viewsRef.add(this);\n              if (this._isFirstRender) {\n                this.initialStyle = {\n                  ...style.initial.value,\n                  ...initialUpdaterRun<StyleProps>(style.initial.updater),\n                };\n              }\n              return this.initialStyle;\n            } else if (hasInlineStyles(style)) {\n              if (this._isFirstRender) {\n                return getInlinePropsUpdate(style);\n              }\n              const newStyle: StyleProps = {};\n              for (const [key, styleValue] of Object.entries(style)) {\n                if (\n                  !isSharedValue(styleValue) &&\n                  !(key === 'transform' && isInlineStyleTransform(styleValue))\n                ) {\n                  newStyle[key] = styleValue;\n                }\n              }\n              return newStyle;\n            } else {\n              return style;\n            }\n          });\n          props[key] = StyleSheet.flatten(processedStyle);\n        } else if (key === 'animatedProps') {\n          const animatedProp = inputProps.animatedProps as Partial<\n            AnimatedComponentProps<AnimatedProps>\n          >;\n          if (animatedProp.initial !== undefined) {\n            Object.keys(animatedProp.initial.value).forEach((key) => {\n              props[key] = animatedProp.initial?.value[key];\n              animatedProp.viewsRef?.add(this);\n            });\n          }\n        } else if (\n          has('current', value) &&\n          value.current instanceof WorkletEventHandler\n        ) {\n          if (value.current.eventNames.length > 0) {\n            value.current.eventNames.forEach((eventName) => {\n              props[eventName] = has('listeners', value.current)\n                ? (value.current.listeners as Record<string, unknown>)[\n                    eventName\n                  ]\n                : dummyListener;\n            });\n          } else {\n            props[key] = dummyListener;\n          }\n        } else if (isSharedValue(value)) {\n          if (this._isFirstRender) {\n            props[key] = (value as SharedValue<any>).value;\n          }\n        } else if (\n          key !== 'onGestureHandlerStateChange' ||\n          !isChromeDebugger()\n        ) {\n          props[key] = value;\n        }\n      }\n      return props;\n    }\n\n    render() {\n      const props = this._filterNonAnimatedProps(this.props);\n      if (isJest()) {\n        props.animatedStyle = this.animatedStyle;\n      }\n\n      if (this._isFirstRender) {\n        this._isFirstRender = false;\n      }\n\n      const platformProps = Platform.select({\n        web: {},\n        default: { collapsable: false },\n      });\n      return (\n        <Component {...props} ref={this._setComponentRef} {...platformProps} />\n      );\n    }\n  }\n\n  AnimatedComponent.displayName = `AnimatedComponent(${\n    Component.displayName || Component.name || 'Component'\n  })`;\n\n  return React.forwardRef<Component>((props, ref) => {\n    return (\n      <AnimatedComponent\n        {...props}\n        {...(ref === null ? null : { forwardedRef: ref })}\n      />\n    );\n  });\n}\n"],"mappings":"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"}